import{v as e,a,u as s,b as l}from"./index.618a2b7d.js";import{f as o,h as r,i as t,o as n,c,a4 as d,b as u,r as i,a as m,z as f,R as p,P as h}from"./vendor.7411dbb7.js";var g=o({emits:["update:modelValue","change"],setup(a,{emit:s}){const l=r(""),o=r(""),n=t("service"),c=()=>{n.open.captcha({height:36,width:110}).then((({captchaId:e,data:a})=>{a.includes(";base64,")?l.value=a:o.value=a,s("update:modelValue",e),s("change",{base64:l,svg:o,captchaId:e})})).catch((a=>{e.error(a)}))};return c(),{base64:l,svg:o,refresh:c}}});const v=d()(((e,a,s,l,o,r)=>(n(),c("div",{class:"login-captcha",onClick:a[1]||(a[1]=(...a)=>e.refresh&&e.refresh(...a))},[e.svg?(n(),c("div",{key:0,class:"svg",innerHTML:e.svg},null,8,["innerHTML"])):(n(),c("img",{key:1,class:"base64",src:e.base64,alt:""},null,8,["src"]))]))));g.render=v,g.__scopeId="data-v-c890fcba";var b=o({components:{Captcha:g},setup(){const o=a(),t=s(),{refs:n,setRefs:c}=l(),d=r(!1),i=u({username:"",password:"",captchaId:"",verifyCode:""});return{refs:n,form:i,saving:d,toLogin:async function(){if(!i.username)return e.warning("用户名不能为空");if(!i.password)return e.warning("密码不能为空");if(!i.verifyCode)return e.warning("图片验证码不能为空");d.value=!0;try{await t.dispatch("userLogin",i),await t.dispatch("userInfo");const[a]=await t.dispatch("permMenu");a?o.push("/"):e.error("该账号没有权限")}catch(a){e.error(a),n.value.captcha.refresh()}d.value=!1},setRefs:c}}});const V={class:"page-login"},w={class:"box"},y=m("img",{class:"logo",src:"/back/assets/logo.b154c076.png",alt:""},null,-1),C=m("p",{class:"desc"},"COOL ADMIN是一款快速开发后台权限管理系统",-1),I=h("登录");b.render=function(e,a,s,l,o,r){const t=i("el-input"),d=i("el-form-item"),u=i("captcha"),h=i("el-form"),g=i("el-button");return n(),c("div",V,[m("div",w,[y,C,m(h,{class:"form",size:"medium",disabled:e.saving},{default:f((()=>[m(d,{label:"用户名"},{default:f((()=>[m(t,{modelValue:e.form.username,"onUpdate:modelValue":a[1]||(a[1]=a=>e.form.username=a),placeholder:"请输入用户名",maxlength:"20","auto-complete":"off"},null,8,["modelValue"])])),_:1}),m(d,{label:"密码"},{default:f((()=>[m(t,{modelValue:e.form.password,"onUpdate:modelValue":a[2]||(a[2]=a=>e.form.password=a),type:"password",placeholder:"请输入密码",maxlength:"20","auto-complete":"off"},null,8,["modelValue"])])),_:1}),m(d,{label:"验证码",class:"captcha"},{default:f((()=>[m(t,{modelValue:e.form.verifyCode,"onUpdate:modelValue":a[3]||(a[3]=a=>e.form.verifyCode=a),placeholder:"请输入图片验证码",maxlength:"4","auto-complete":"off",onKeyup:p(e.toLogin,["enter"])},null,8,["modelValue","onKeyup"]),m(u,{ref:e.setRefs("captcha"),modelValue:e.form.captchaId,"onUpdate:modelValue":a[4]||(a[4]=a=>e.form.captchaId=a),class:"value",onChange:a[5]||(a[5]=()=>{e.form.verifyCode=""})},null,8,["modelValue"])])),_:1})])),_:1},8,["disabled"]),m(g,{round:"",size:"mini",class:"submit-btn",loading:e.saving,onClick:e.toLogin},{default:f((()=>[I])),_:1},8,["loading","onClick"])])])};export default b;
